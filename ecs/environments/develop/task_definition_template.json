{
  "ipcMode": null,
  "executionRoleArn": "arn:aws:iam::AWS_ACCOUNT_ID:role/ecs-service-role-develop",
  "containerDefinitions": [
    {
      "name": "service-api-nginx-develop",
      "dnsSearchDomains": null,
      "environmentFiles": null,
      "logConfiguration": {
        "logDriver": "awsfirelens",
        "secretOptions": null,
        "options": {
          "Name": "datadog",
          "Host": "http-intake.logs.datadoghq.com",
          "TLS": "on",
          "dd_service": "service-api",
          "dd_source": "service-api-nginx",
          "dd_tags": "Service:service-api,Env:develop",
          "provider": "ecs"
        },
        "secretOptions": [{
          "name": "apikey",
          "valueFrom": "/app/common/datadog/dd_api_key"
        }]
      },
      "entryPoint": null,
      "portMappings": [
        {
          "hostPort": 80,
          "protocol": "tcp",
          "containerPort": 80
        },
        {
          "hostPort": 5201,
          "protocol": "tcp",
          "containerPort": 5201
        },
        {
          "hostPort": 5001,
          "protocol": "tcp",
          "containerPort": 5001
        }
      ],
      "command": null,
      "linuxParameters": null,
      "cpu": 0,
      "environment": [],
      "resourceRequirements": null,
      "ulimits": [
        {
            "name": "nofile",
            "softLimit": 703358,
            "hardLimit": 703358
        }
      ],
      "dnsServers": null,
      "mountPoints": [
        {
          "sourceVolume": "php-fpm-socket",
          "containerPath": "/var/run/php-fpm"
        }
      ],
      "workingDirectory": null,
      "secrets": null,
      "dockerSecurityOptions": null,
      "memory": null,
      "memoryReservation": null,
      "volumesFrom": [
        {
          "sourceContainer": "service-api-php-fpm-develop",
          "readOnly": true
        }
      ],
      "stopTimeout": null,
      "image": "<REPOSITORY_URI_NGINX>",
      "startTimeout": null,
      "firelensConfiguration": null,
      "dependsOn": [
        {
          "containerName": "service-api-php-fpm-develop",
          "condition": "START"
        }
      ],
      "disableNetworking": null,
      "interactive": null,
      "healthCheck": {
        "command": ["CMD-SHELL", "curl -f http://localhost/check-health-status || exit 1"],
        "interval": 5,
        "timeout": 5,
        "retries": 10
      },
      "essential": true,
      "links": null,
      "hostname": null,
      "extraHosts": null,
      "pseudoTerminal": null,
      "user": null,
      "readonlyRootFilesystem": null,
      "dockerLabels": null,
      "systemControls": null,
      "privileged": null
    },
    {
      "name": "service-api-php-fpm-develop",
      "dnsSearchDomains": null,
      "portMappings": [],
      "environmentFiles": null,
      "logConfiguration": {
        "logDriver": "awsfirelens",
        "secretOptions": null,
        "options": {
          "Name": "datadog",
          "Host": "http-intake.logs.datadoghq.com",
          "TLS": "on",
          "dd_service": "service-api",
          "dd_source": "service-api-nginx",
          "dd_tags": "Service:service-api,Env:develop",
          "provider": "ecs"
        },
        "secretOptions": [{
          "name": "apikey",
          "valueFrom": "/app/common/datadog/dd_api_key"
        }]
      },
      "entryPoint": null,
      "command": null,
      "linuxParameters": null,
      "cpu": 0,
      "environment": [],
      "resourceRequirements": null,
      "ulimits": [
        {
            "name": "nofile",
            "softLimit": 703358,
            "hardLimit": 703358
        }
      ],
      "dnsServers": null,
      "mountPoints": [
        {
          "sourceVolume": "php-fpm-socket",
          "containerPath": "/var/run/php-fpm"
        }
      ],
      "workingDirectory": null,
      "secrets": null,
      "dockerSecurityOptions": null,
      "memory": null,
      "memoryReservation": null,
      "volumesFrom": [],
      "stopTimeout": null,
      "image": "<REPOSITORY_URI_PHP_FPM>",
      "startTimeout": null,
      "firelensConfiguration": null,
      "dependsOn": null,
      "disableNetworking": null,
      "interactive": null,
      "healthCheck": null,
      "essential": true,
      "links": null,
      "hostname": null,
      "extraHosts": null,
      "pseudoTerminal": null,
      "user": null,
      "readonlyRootFilesystem": null,
      "dockerLabels": null,
      "systemControls": null,
      "privileged": null,
      "secrets": [
        {
          "name": "APP_KEY",
          "valueFrom": "/app/develop/ecs/service-api/env/APP_KEY"
        },
        {
          "name": "DB_HOST",
          "valueFrom": "/app/develop/ecs/service-api/env/DB_HOST"
        },
        {
          "name": "DB_PORT",
          "valueFrom": "/app/develop/ecs/service-api/env/DB_PORT"
        },
        {
          "name": "DB_DATABASE",
          "valueFrom": "/app/develop/ecs/service-api/env/DB_DATABASE"
        },
        {
          "name": "DB_USERNAME",
          "valueFrom": "/app/develop/ecs/service-api/env/DB_USERNAME"
        },
        {
          "name": "DB_PASSWORD",
          "valueFrom": "/app/develop/ecs/service-api/env/DB_PASSWORD"
        }
      ],
      "environment": [
        {
          "name" : "APP_NAME",
          "value" : "Laravel"
        },
        {
          "name" : "APP_ENV",
          "value" : "dev"
        },
        {
          "name": "APP_DEBUG",
          "value": "false"
        },
        {
          "name" : "APP_URL",
          "value" : "http://localhost"
        },
        {
          "name" : "LOG_CHANNEL",
          "value" : "stack"
        },
        {
          "name" : "DEBUG_REQUEST",
          "value" : "true"
        },
        {
          "name" : "DB_CONNECTION",
          "value" : "mysql"
        },
        {
          "name" : "BROADCAST_DRIVER",
          "value" : "log"
        },
        {
          "name" : "CACHE_DRIVER",
          "value" : "file"
        },
        {
          "name" : "QUEUE_CONNECTION",
          "value" : "sync"
        },
        {
          "name" : "SESSION_DRIVER",
          "value" : "file"
        },
        {
          "name" : "SESSION_LIFETIME",
          "value" : "120"
        },
        {
          "name" : "REDIS_HOST",
          "value" : "app-dev.ukevnq.ng.0001.apne1.cache.amazonaws.com"
        },
        {
          "name" : "REDIS_PASSWORD",
          "value" : ""
        },
        {
          "name" : "REDIS_PORT",
          "value" : "6379"
        },
        {
          "name" : "MAIL_DRIVER",
          "value" : "smtp"
        },
        {
          "name" : "MAIL_HOST",
          "value" : "smtp.mailtrap.io"
        },
        {
          "name" : "MAIL_DRIVER",
          "value" : "smtp"
        },
        {
          "name" : "MAIL_PORT",
          "value" : "2525"
        },
        {
          "name" : "MAIL_USERNAME",
          "value" : ""
        },
        {
          "name" : "MAIL_PASSWORD",
          "value" : ""
        },
        {
          "name" : "MAIL_ENCRYPTION",
          "value" : ""
        }
      ]
    },
    {
      "image": "datadog/agent:latest",
      "logConfiguration": {
        "logDriver": "awsfirelens",
        "options": null
      },
      "cpu": 10,
      "memory": 256,
      "mountPoints": [],
      "portMappings": [
        {
          "hostPort": 8126,
          "protocol": "tcp",
          "containerPort": 8126
        }
      ],
      "environment": [
        {
          "name" : "ECS_FARGATE",
          "value" : "true"
        },
        {
          "name" : "DD_PROCESS_AGENT_ENABLED",
          "value" : "true"
        },
        {
          "name": "DD_APM_ENABLED",
          "value": "true"
        },
        {
          "name": "DD_APM_NON_LOCAL_TRAFFIC",
          "value": "true"
        },
        {
          "name" : "DD_DOGSTATSD_NON_LOCAL_TRAFFIC",
          "value" : "true"
        }
      ],
      "name": "datadog-agent",
      "secrets": [
        {
          "name": "DD_API_KEY",
          "valueFrom": "/app/common/datadog/dd_api_key"
        }
      ]
    },
    {
      "name": "log_router",
      "image": "<REPOSITORY_URI_FLUENTBIT>",
      "essential": true,
      "firelensConfiguration": {
        "type": "fluentbit",
        "options": {
          "config-file-type": "file",
          "config-file-value": "/fluent-bit/etc/extra.conf"
        }
      },
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-group": "/ecs/develop/containers/service-api/fluentbit",
          "awslogs-region": "ap-northeast-1",
          "awslogs-stream-prefix": "fluentbit"
        }
      },
      "cpu": 0,
      "environment": [],
      "mountPoints": [],
      "volumesFrom": [],
      "portMappings": [],
      "user": "0"
    }
  ],
  "placementConstraints": [],
  "memory": "4096",
  "taskRoleArn": "arn:aws:iam::AWS_ACCOUNT_ID:role/ecs-service-role-develop",
  "compatibilities": [
    "EC2",
    "FARGATE"
  ],
  "taskDefinitionArn": "arn:aws:ecs:ap-northeast-1:AWS_ACCOUNT_ID:task-definition/service-api-develop",
  "family": "service-api-develop",
  "requiresAttributes": [
    {
      "targetId": null,
      "targetType": null,
      "value": null,
      "name": "com.amazonaws.ecs.capability.logging-driver.awslogs"
    },
    {
      "targetId": null,
      "targetType": null,
      "value": null,
      "name": "ecs.capability.execution-role-awslogs"
    },
    {
      "targetId": null,
      "targetType": null,
      "value": null,
      "name": "com.amazonaws.ecs.capability.ecr-service"
    },
    {
      "targetId": null,
      "targetType": null,
      "value": null,
      "name": "com.amazonaws.ecs.capability.docker-remote-api.1.19"
    },
    {
      "targetId": null,
      "targetType": null,
      "value": null,
      "name": "com.amazonaws.ecs.capability.task-iam-role"
    },
    {
      "targetId": null,
      "targetType": null,
      "value": null,
      "name": "ecs.capability.execution-role-ecr-pull"
    },
    {
      "targetId": null,
      "targetType": null,
      "value": null,
      "name": "com.amazonaws.ecs.capability.docker-remote-api.1.18"
    },
    {
      "targetId": null,
      "targetType": null,
      "value": null,
      "name": "ecs.capability.task-eni"
    }
  ],
  "pidMode": null,
  "requiresCompatibilities": [
    "FARGATE"
  ],
  "networkMode": "awsvpc",
  "runtimePlatform": null,
  "cpu": "2048",
  "revision": 19,
  "status": "ACTIVE",
  "inferenceAccelerators": null,
  "proxyConfiguration": null,
  "volumes": [
    {
      "name": "php-fpm-socket"
    }
  ]
}